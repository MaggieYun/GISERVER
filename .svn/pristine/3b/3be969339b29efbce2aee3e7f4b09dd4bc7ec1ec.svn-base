#coding=utf-8
import os,sys
# from sqlalchemy import create_engine
# from style import *
from layerdef import *
from layer import *
from layerfactory import *


if __name__ == '__main__':
    dirpath = os.path.dirname(__file__)
    path = os.path.join(dirpath, "configs")
    
    layerFactory = LayerFactory(path)
    layer1=layerFactory.createLayer('config2')
    print "errors:",layer1.definition.errors

    bbox = (120.513513,31.28561972,120.98838306,31.36400551)
    where = ["TASK_POINT_ID","<10"]
    insr = 4326
    outfields = ["TASK_POINT_ID","TASK_POINT_LONGITUDE","TASK_POINT_LATITUDE"]
    outsr = 4326
    
    queryParameter = QueryParameter(bbox,where,insr,outfields,outsr)
    queryResult = layer1.query(queryParameter)
    
    print "aliases:",queryResult.aliases
    print "fields:",queryResult.fields
    print "features:",queryResult.features
    print "type:",queryResult.type






    # # print layerFactory.LAYER_CACHE
    # # layer2=layerFactory.createLayer('config2')  #验证缓存
    # print "_______________________________________"
    # layer2=layerFactory.createLayer('a\config')

    # errors2 = layer2.definition.validate()
    # print errors2

    # print "_______________________________________"
    # layer3=layerFactory.createLayer('config1')
    # errors3 = layer3.definition.validate()
    # print errors3



